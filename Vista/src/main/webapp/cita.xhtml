<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">
<h:head>
    <h:outputStylesheet name="css/patrondental.css" />
    <title>Solicitar Cita - SoftDentist</title>
    <style>
        .form-container {
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
        }
        .field-group {
            margin-bottom: 20px;
        }
        .field-label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }
        .horario-info {
            display: block;
            font-size: 12px;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }
        .ui-selectonemenu {
            width: 100% !important;
        }
    </style>
</h:head>

<h:body>
    <!-- Toast para mensajes -->
    <p:growl id="messages" showDetail="true" life="3000" />

    <div class="form-container">
        <h:form id="citaForm">
            <p:panel header="Solicitar Nueva Cita" style="width: 100%">

                <div class="field-group">
                    <p:outputLabel for="paciente" value="Paciente: *" styleClass="field-label" />
                    <p:selectOneMenu id="paciente" value="#{citaBean.pacienteSeleccionadoId}" style="width:100%">
                        <f:selectItem itemLabel="Seleccione un paciente" itemValue="#{null}" />
                        <f:selectItems value="#{citaBean.pacientesDisponibles}" var="p"
                                       itemLabel="#{p.nombre} #{p.apellido}"
                                       itemValue="#{p.id}" />
                    </p:selectOneMenu>
                    <p:message for="paciente" />
                </div>


                <div class="field-group">
                    <p:outputLabel for="fecha" value="Fecha de la cita: *" styleClass="field-label" />
                    <p:datePicker id="fecha"
                                  value="#{citaBean.fecha}"
                                  required="true"
                                  requiredMessage="La fecha es obligatoria"
                                  showIcon="true"
                                  pattern="yyyy-MM-dd">
                        <p:ajax event="dateSelect" listener="#{citaBean.onDateSelect}" update="hora motivo"/>
                    </p:datePicker>
                    <p:message for="fecha" />
                </div>

                <!-- Hora como menú desplegable -->
                <div class="field-group">
                    <p:outputLabel for="hora" value="Hora de la cita: *" styleClass="field-label" />
                    <p:selectOneMenu id="hora" value="#{citaBean.hora}"
                                     required="true"
                                     requiredMessage="La hora es obligatoria"
                                     style="width: 100%">
                        <f:selectItem itemLabel="Seleccione una hora" itemValue="#{null}" />
                        <f:selectItems value="#{citaBean.horasDisponibles}" var="horaItem"
                                       itemLabel="#{horaItem}" itemValue="#{horaItem}" />
                    </p:selectOneMenu>

                    <p:message for="hora" />
                    <p:outputLabel value="Horario: Lunes a Viernes 10:00 - 20:00, Sábados 8:00 - 14:00, Domingos Cerrado"
                                   styleClass="horario-info" />
                </div>

                <!-- Motivo -->
                <div class="field-group">
                    <p:outputLabel for="motivo" value="Motivo de la cita: *" styleClass="field-label" />
                    <p:inputTextarea id="motivo" value="#{citaBean.motivo}"
                                     rows="4"
                                     style="width: 100%"
                                     required="true"
                                     requiredMessage="El motivo es obligatorio"
                                     placeholder="Describa el motivo de su consulta..."
                                     autoResize="false" />
                    <p:message for="motivo" />
                </div>

                <!-- Botones -->
                <div class="field-group" style="text-align: center; margin-top: 30px;">
                    <p:commandButton value="Solicitar Cita"
                                     action="#{citaBean.solicitarCita}"
                                     update=":messages"
                                     oncomplete="if(!args.validationFailed) PF('messages').show()"
                                     styleClass="ui-button-primary"
                                     icon="pi pi-calendar-plus"
                                     process="@form" />
                </div>

            </p:panel>
        </h:form>
    </div>

</h:body>
</html>
